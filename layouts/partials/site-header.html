{{- $page := . -}}
{{- $logo := site.Params.logo_text | default "Yauheni Kazheka" -}}
{{- $menu := slice -}}
{{- if site.Menus.main -}}
  {{- range site.Menus.main -}}
    {{- $menu = $menu | append (dict "label" .Name "url" (.URL | relURL) "active" ($page.IsMenuCurrent "main" .)) -}}
  {{- end -}}
{{- else -}}
  {{- $homeURL := "/" -}}
  {{- with site.Home -}}
    {{- $homeURL = .RelPermalink -}}
  {{- end -}}
  {{- $menu = slice
        (dict "label" "Home" "url" $homeURL "active" $page.IsHome)
        (dict "label" "About" "url" "/about/" "active" (eq ($page.RelPermalink | default "") "/about/"))
    -}}
{{- end -}}
<header class="fixed inset-x-0 top-0 z-50 border-b border-brand-border-header bg-brand-surface-base text-brand-text-heading shadow-header">
  <div class="mx-auto max-w-6xl px-4">
    <div class="flex items-center justify-between py-3">
      <a class="text-lg font-semibold tracking-tight text-brand-text-heading no-underline hover:text-brand-accent-primary hover:no-underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-accent-primary focus-visible:ring-offset-2 focus-visible:ring-offset-brand-surface-base" href="{{ site.Home.RelPermalink | default "/" }}">
        {{ $logo }}
      </a>
      
      {{- /* Mobile Menu Toggle Button - visible only on small screens */ -}}
      <button 
        type="button"
        class="sm:hidden inline-flex min-h-[44px] min-w-[44px] items-center justify-center rounded-md p-2 text-brand-text-muted hover:text-brand-accent-primary hover:bg-brand-surface-secondary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-accent-primary focus-visible:ring-offset-2 focus-visible:ring-offset-brand-surface-base"
        aria-expanded="false"
        aria-controls="primary-navigation"
        data-mobile-menu-toggle
      >
        <span class="sr-only" data-mobile-menu-state>Show navigation menu</span>
        {{- /* Hamburger icon - shown when menu is closed */ -}}
        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-mobile-menu-icon-open>
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
        {{- /* X icon - shown when menu is open */ -}}
        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-mobile-menu-icon-close hidden>
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>

      {{- /* Unified Navigation - adapts layout for mobile/desktop */ -}}
      <nav 
        id="primary-navigation"
        aria-label="Primary"
        class="hidden sm:block sm:static sm:border-t-0 sm:bg-transparent absolute inset-x-0 top-full border-t border-brand-border-base bg-brand-surface-base px-4 sm:px-0"
        data-mobile-menu
        data-state="closed"
      >
        <ul class="flex flex-col gap-0 py-2 text-[14px] font-medium leading-[1.4] sm:flex-row sm:gap-4 sm:py-0">
          {{- range $menu -}}
            <li>
              <a href="{{ .url }}" class="block min-h-[44px] rounded-md px-3 py-2 transition-colors duration-150 no-underline hover:no-underline sm:inline-flex sm:items-center sm:gap-1 sm:py-1 {{ if .active }}text-brand-accent-primary{{ else }}text-brand-text-heading hover:text-brand-accent-primary{{ end }} focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-accent-primary focus-visible:ring-offset-2 focus-visible:ring-offset-brand-surface-base" data-mobile-menu-link>
                {{ .label }}
              </a>
            </li>
          {{- end -}}
        </ul>
      </nav>
    </div>
  </div>
</header>
