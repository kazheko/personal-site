{{ define "main" }}
  {{- $titleSlug := printf "post-title-%s" (.Title | urlize) -}}
  <article class="post-shell" aria-labelledby="{{ $titleSlug }}">
    {{ partial "post-meta-row.html" . }}
    <header class="post-shell__header">
      <h1 id="{{ $titleSlug }}" class="post-shell__title">
        {{ .Title }}
      </h1>
    </header>
    <div class="prose mt-10">
      {{ .Content }}
    </div>
  </article>
  {{ partial "zoom-overlay.html" . }}
{{ end }}

{{ define "page_scripts" }}
  {{- $imageZoom := resources.Get "js/image-zoom.js" -}}
  {{- if $imageZoom -}}
    {{- $zoomBuilt := $imageZoom | js.Build (dict "format" "esm" "target" "es2017" "minify" false) -}}
    {{- if hugo.IsProduction -}}
      {{- $zoomBuilt = $zoomBuilt | minify | resources.Fingerprint "sha256" -}}
    {{- end -}}
    <script type="module" src="{{ $zoomBuilt.RelPermalink }}"{{ if hugo.IsProduction }} integrity="{{ $zoomBuilt.Data.Integrity }}"{{ end }}></script>
  {{- end -}}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "{{ .Title }}",
    "datePublished": "{{ .Date }}",
    "dateModified": "{{ .Lastmod }}",
    "author": {
      "@type": "Person",
      "name": "{{ .Site.Params.author.name }}"
    }
  }
  </script>
{{ end }}